`Typescript`源代码目录，存在脚本主体及模块源代码。

### 结构说明
1. core：脚本最基础核心模块所在，建构脚本基础组件，对应的输出文件在脚本中默认载入且拥有最高优先级。
2. index.ts：脚本主体源码，编译后将生成拓展名为`.user.js`的用户脚本文本本体。

### 模块释名
本项目所指的“模块”区别于`ES6`、`AMD`的模块，更类似一个普通的`.ts/.js`文件，所以请像编写普通ts/js文件一样编写，**不要**引入任何只能在其他模块中可能存在的语法，包括但不限于：
   - es6的模块导出关键词`export`
   - es6模块顶层`await`

本项目所指的“模块”与一般ts/js文件唯一的区别是这些模块可以不声明直接就使用一些变量，因为她们是经过一种类似函数传参一样传递过来的，用法上与函数的传参也几乎没有区别，包括：
   - API：负责模块数据沟通，函数传递的对象，类似于顶层对象`window`的存在，需要暴露函数、变量等数据给其他模块时请添加为她的属性。
   - config：记录了脚本的设置数据的对象。
   - GM：封装了`TamperMonkey`提供的高级API的对象。**注意：原`GM_*`形式的API在模块中并不可用，请以本对象的属性(`GM.*`)的形式代替！**
   - importModule：负责载入其他“模块”的函数，本项目模块唯一指定模块载入方法。  

当然除了这些，引入模块时也可以主动传递一些“变量”给那个被引入的模块，只需要在使用`importModule`时传入即可。
<details>
    <summary>查看示例</summary>
    <pre>
// a.js       
importModule("b.js",{ debug: console.log, x: x });
// b.js
debug(x); // 控制台打印"1"
    </pre>
    <p>这个例子在a.js中引入了b.js，并将原生方法console.log及一个常量x传递了过去，在b.js中就可以直接使用这两个数据在控制台打印了数字"1"</p>
</details>

### 模块规范
1. 任何功能代码都可以单独作为一个“模块”，可以放在本目录的任何位置，可以新建子目录，也可以新建子目录的子目录。
2. 本目录下只能存在`Typescript`文件，“模块”中有用到其他类型资源请存放到对应的上级目录或者使用在线资源。
3. 无论模块放在哪个目录或者子目录，请保持文件名(包括拓展名)的**唯一**，因为`importModule`载入模块时使用的只是文件名而不包含路径，同名文件将导致错误。
4. 模块中可以使用`importModule`方法按需加载其他模块，对于这种按需加载的模块如不确定是否已经载入可以在每次用到时都载入一次，如已载入会自动忽略的。
5. 模块核心代码请放在一个自运行函数中，以免污染顶层命名空间，导致`tslint`报各种错误及警告。
6. 往`API`上暴露数据时请主动在模块顶层底部拓展声明，声明写法可参考现成的其他模块。
7. `API`其他模块暴露数据请直接以对象属性的方式使用，不要重新声明为其他变量，以免丢失引用无法同步数据。

### 运行流程
脚本主体`index.js` -> core目录下的核心模块 -> `rewrite.js` -> `normal.js`  
实际功能引导主要添加在`rewrite.js`和`normal.js`中，由于脚本重写页面功能的实现特殊，这两部分的顺序是固定的，`rewrite.js`处理完重写页面才是其他功能运行的时机，所以一般的功能的引导都在`normal.js`。特殊的如一些只在某个重写后的页面中才需要运行的模块，可以引导在`rewrite.js`导入个对应模块中。
